import{r as i,n as l}from"./index-DD76fs-h.js";import N from"./InvoiceList-DhM3nGc7.js";import D from"./InvoiceForm-qcUyOSow.js";import{s}from"./index-CL6WArkk.js";import{D as F}from"./index-CKDW8ldq.js";import"./jspdf.es.min-Csoo9Yjq.js";import"./jspdf.plugin.autotable-TLQB5wf7.js";import"./index-xsH4HHeE.js";import"./index-CVolLEbg.js";import"./row-qnhl_Xtb.js";import"./TextArea-CMtgeMII.js";import"./index-Bz8HKjRU.js";import"./index-BvxoHc-c.js";import"./useClosable-DEE2SN-J.js";import"./index-Cyejg2uk.js";import"./Table-Bd4A0fxf.js";import"./index-ZtJ4PVaR.js";import"./index-BjXlmfRw.js";import"./index-DfZabzEr.js";import"./context-CGg-q3Eq.js";import"./DeleteOutlined-QhKYsw_D.js";import"./SendOutlined-C8Sl0Eao.js";import"./index-C7mdu0c-.js";import"./index-CFl-p7rD.js";import"./PlusOutlined-M3Xgh6eT.js";import"./index-Dx7S66AB.js";import"./index-keQBqU8z.js";import"./InfoCircleFilled-AVuMim3v.js";import"./index-C70Jm7S8.js";import"./MessageOutlined-Wt4EX-mr.js";import"./callSuper-BwtWTB_J.js";import"./index-BelEbI9C.js";import"./index-C8gyv-gM.js";import"./SaveOutlined-e6ymyoOE.js";const ae=()=>{const[d,I]=i.useState([]),[y,n]=i.useState(!1),[o,c]=i.useState(null),[u,h]=i.useState([]);i.useEffect(()=>{a()},[]);const a=async()=>{try{const t=await(await fetch("/api/invoices")).json();I(t)}catch{s.error("Failed to fetch invoices")}},S=async e=>{try{const t=o?"PUT":"POST",p=o?`/api/invoices/${o._id}`:"/api/invoices",r=await fetch(p,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),m=await r.json();if(r.ok)s.success(o?"Invoice updated":"Invoice created"),a(),n(!1),c(null);else throw new Error(m.error||"Failed to save")}catch(t){s.error(t.message)}},C=e=>{c(e),n(!0)},E=async e=>{try{await fetch(`/api/invoices/${e}`,{method:"DELETE"}),s.success("Invoice deleted"),a()}catch{s.error("Delete failed")}},j=()=>{n(!0),c(null)},v=()=>{n(!1),c(null)},x=e=>{if(!e)return h([]);const t=e.toLowerCase(),p=d.filter(r=>{var m,f,w;return((m=r.businessName)==null?void 0:m.toLowerCase().includes(t))||((f=r.invoiceNumber)==null?void 0:f.toLowerCase().includes(t))||((w=r.customerName)==null?void 0:w.toLowerCase().includes(t))});h(p)};return l.jsxs("div",{style:{padding:24},children:[l.jsx(N,{invoices:u.length>0?u:d,onAddNew:j,onEdit:C,onDelete:E,onSearch:x,refreshInvoices:a}),l.jsx(F,{title:o?"Edit Invoice":"New Invoice",width:800,open:y,onClose:v,destroyOnClose:!0,children:l.jsx(D,{onCancel:v,onSave:S,initialValues:o})})]})};export{ae as default};
