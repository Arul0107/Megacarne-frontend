import{r as h,x as e,B as n,H as k,V as i}from"./index-t5rVtybA.js";import{i as d}from"./axios-tnHzrPy3.js";import{F as p}from"./index-DKyXNU95.js";import{R}from"./PlusOutlined-CaKX0zvq.js";import{F as v}from"./Table-DRoRyLkd.js";import{D as E}from"./index-B6r09JUu.js";import{I as A}from"./index-C3SbKcBe.js";import{R as O}from"./EditOutlined-BeogT0LA.js";import{P as _}from"./index-DNd6prTs.js";import{R as $}from"./DeleteOutlined-DdstezQk.js";import"./TextArea-BasEnP5_.js";import"./styleChecker-Cm9BPmqX.js";import"./addEventListener-5Sesl6IS.js";import"./index-C9JDh5Qg.js";import"./index-CCGxcpAJ.js";import"./Pagination-DSK_3Iwp.js";import"./useClosable-Dv5ScLmI.js";import"./context-CPH9Yf_c.js";import"./ActionButton-BsySh9uh.js";const ee=({departments:D,fetchDepartments:u,fetchTeams:x,fetchUsers:f})=>{const[C,o]=h.useState(!1),[l,g]=h.useState(null),[m]=p.useForm(),s=JSON.parse(localStorage.getItem("user")),j=(s==null?void 0:s.role)==="Superadmin",y=(s==null?void 0:s.role)==="Admin",w=()=>{g(null),m.resetFields(),o(!0)},F=r=>{g(r),m.setFieldsValue({name:r.name,description:r.description}),o(!0)},b=async()=>{var r,a;try{const t=await m.validateFields();l?(await d.put(`/api/departments/${l._id}`,t),i.success("Department updated successfully")):(await d.post("/api/departments",t),i.success("Department created successfully")),o(!1),u(),x(),f()}catch(t){console.error(t),i.error(((a=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to submit department")}},I=async r=>{var a,t;try{await d.delete(`/api/departments/${r}`),i.success("Department deleted"),u(),x(),f()}catch(c){i.error(((t=(a=c==null?void 0:c.response)==null?void 0:a.data)==null?void 0:t.message)||"Delete failed")}},S=[{title:"Name",dataIndex:"name",key:"name"},{title:"Actions",key:"actions",render:(r,a)=>e.jsx(k,{children:(j||y)&&e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:e.jsx(O,{}),onClick:()=>F(a)}),e.jsx(_,{title:"Delete this department?",onConfirm:()=>I(a._id),children:e.jsx(n,{danger:!0,icon:e.jsx($,{})})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Department Management"}),(j||y)&&e.jsx(n,{type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},icon:e.jsx(R,{}),onClick:w,children:"Create Department"})]}),e.jsx(v,{columns:S,dataSource:D,rowKey:"_id",bordered:!0}),e.jsx(E,{title:l?"Edit Department":"Create Department",open:C,onClose:()=>o(!1),width:420,destroyOnClose:!0,footer:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(n,{onClick:()=>o(!1),style:{marginRight:8},children:"Cancel"}),e.jsx(n,{type:"primary",style:{backgroundColor:"#ef7a1b",borderColor:"#orange",color:"white"},onClick:b,children:l?"Update":"Create"})]}),children:e.jsx(p,{form:m,layout:"vertical",children:e.jsx(p.Item,{name:"name",label:"Department Name",rules:[{required:!0,message:"Department name is required"}],children:e.jsx(A,{})})})})]})};export{ee as default};
