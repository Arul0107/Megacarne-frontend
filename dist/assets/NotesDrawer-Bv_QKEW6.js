import{r as S,m as J,P as F,j as Q,y as W,k as z,t as Y,ak as O,z as V,A as ee,C as ne,D as C,al as te,a1 as ae,J as se,ad as ie,H as re,am as le,an as ce,R,p as e,B as L,s as A}from"./index-CKWzJZwz.js";import{F as o}from"./index-BkOdznK5.js";import{D as B}from"./index-snvmcnDO.js";import{R as P,C as $}from"./row-vY193qbU.js";import{I as g}from"./index-D547GtUq.js";import{T as de}from"./index-DZ16B_2c.js";import{S as X}from"./index-DHfbdJKK.js";import{i as oe}from"./axios-0yhrvgHk.js";import{D as he}from"./index-Be92sfkX.js";import{R as me}from"./PlusOutlined-B6wL2tqI.js";import{T as ue}from"./index-CLITIDam.js";var ge=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],K=S.forwardRef(function(n,t){var r,a=n.prefixCls,c=a===void 0?"rc-switch":a,d=n.className,h=n.checked,s=n.defaultChecked,i=n.disabled,l=n.loadingIcon,u=n.checkedChildren,p=n.unCheckedChildren,m=n.onClick,x=n.onChange,b=n.onKeyDown,w=J(n,ge),N=F(!1,{value:h,defaultValue:s}),f=Q(N,2),v=f[0],y=f[1];function M(I,E){var k=v;return i||(k=I,y(k),x==null||x(k,E)),k}function D(I){I.which===O.LEFT?M(!1,I):I.which===O.RIGHT&&M(!0,I),b==null||b(I)}function j(I){var E=M(!v,I);m==null||m(E,I)}var q=W(c,d,(r={},z(r,"".concat(c,"-checked"),v),z(r,"".concat(c,"-disabled"),i),r));return S.createElement("button",Y({},w,{type:"button",role:"switch","aria-checked":v,disabled:i,className:q,ref:t,onKeyDown:D,onClick:j}),l,S.createElement("span",{className:"".concat(c,"-inner")},S.createElement("span",{className:"".concat(c,"-inner-checked")},u),S.createElement("span",{className:"".concat(c,"-inner-unchecked")},p)))});K.displayName="Switch";const pe=n=>{const{componentCls:t,trackHeightSM:r,trackPadding:a,trackMinWidthSM:c,innerMinMarginSM:d,innerMaxMarginSM:h,handleSizeSM:s,calc:i}=n,l=`${t}-inner`,u=C(i(s).add(i(a).mul(2)).equal()),p=C(i(h).mul(2).equal());return{[t]:{[`&${t}-small`]:{minWidth:c,height:r,lineHeight:C(r),[`${t}-inner`]:{paddingInlineStart:h,paddingInlineEnd:d,[`${l}-checked, ${l}-unchecked`]:{minHeight:r},[`${l}-checked`]:{marginInlineStart:`calc(-100% + ${u} - ${p})`,marginInlineEnd:`calc(100% - ${u} + ${p})`},[`${l}-unchecked`]:{marginTop:i(r).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${t}-handle`]:{width:s,height:s},[`${t}-loading-icon`]:{top:i(i(s).sub(n.switchLoadingIconSize)).div(2).equal(),fontSize:n.switchLoadingIconSize},[`&${t}-checked`]:{[`${t}-inner`]:{paddingInlineStart:d,paddingInlineEnd:h,[`${l}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${l}-unchecked`]:{marginInlineStart:`calc(100% - ${u} + ${p})`,marginInlineEnd:`calc(-100% + ${u} - ${p})`}},[`${t}-handle`]:{insetInlineStart:`calc(100% - ${C(i(s).add(a).equal())})`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${l}`]:{[`${l}-unchecked`]:{marginInlineStart:i(n.marginXXS).div(2).equal(),marginInlineEnd:i(n.marginXXS).mul(-1).div(2).equal()}},[`&${t}-checked ${l}`]:{[`${l}-checked`]:{marginInlineStart:i(n.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:i(n.marginXXS).div(2).equal()}}}}}}},xe=n=>{const{componentCls:t,handleSize:r,calc:a}=n;return{[t]:{[`${t}-loading-icon${n.iconCls}`]:{position:"relative",top:a(a(r).sub(n.fontSize)).div(2).equal(),color:n.switchLoadingIconColor,verticalAlign:"top"},[`&${t}-checked ${t}-loading-icon`]:{color:n.switchColor}}}},Se=n=>{const{componentCls:t,trackPadding:r,handleBg:a,handleShadow:c,handleSize:d,calc:h}=n,s=`${t}-handle`;return{[t]:{[s]:{position:"absolute",top:r,insetInlineStart:r,width:d,height:d,transition:`all ${n.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:a,borderRadius:h(d).div(2).equal(),boxShadow:c,transition:`all ${n.switchDuration} ease-in-out`,content:'""'}},[`&${t}-checked ${s}`]:{insetInlineStart:`calc(100% - ${C(h(d).add(r).equal())})`},[`&:not(${t}-disabled):active`]:{[`${s}::before`]:{insetInlineEnd:n.switchHandleActiveInset,insetInlineStart:0},[`&${t}-checked ${s}::before`]:{insetInlineEnd:0,insetInlineStart:n.switchHandleActiveInset}}}}},be=n=>{const{componentCls:t,trackHeight:r,trackPadding:a,innerMinMargin:c,innerMaxMargin:d,handleSize:h,calc:s}=n,i=`${t}-inner`,l=C(s(h).add(s(a).mul(2)).equal()),u=C(s(d).mul(2).equal());return{[t]:{[i]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:d,paddingInlineEnd:c,transition:`padding-inline-start ${n.switchDuration} ease-in-out, padding-inline-end ${n.switchDuration} ease-in-out`,[`${i}-checked, ${i}-unchecked`]:{display:"block",color:n.colorTextLightSolid,fontSize:n.fontSizeSM,transition:`margin-inline-start ${n.switchDuration} ease-in-out, margin-inline-end ${n.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:r},[`${i}-checked`]:{marginInlineStart:`calc(-100% + ${l} - ${u})`,marginInlineEnd:`calc(100% - ${l} + ${u})`},[`${i}-unchecked`]:{marginTop:s(r).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${t}-checked ${i}`]:{paddingInlineStart:c,paddingInlineEnd:d,[`${i}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${i}-unchecked`]:{marginInlineStart:`calc(100% - ${l} + ${u})`,marginInlineEnd:`calc(-100% + ${l} - ${u})`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${i}`]:{[`${i}-unchecked`]:{marginInlineStart:s(a).mul(2).equal(),marginInlineEnd:s(a).mul(-1).mul(2).equal()}},[`&${t}-checked ${i}`]:{[`${i}-checked`]:{marginInlineStart:s(a).mul(-1).mul(2).equal(),marginInlineEnd:s(a).mul(2).equal()}}}}}},Ie=n=>{const{componentCls:t,trackHeight:r,trackMinWidth:a}=n;return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},ne(n)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:a,height:r,lineHeight:C(r),verticalAlign:"middle",background:n.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${n.motionDurationMid}`,userSelect:"none",[`&:hover:not(${t}-disabled)`]:{background:n.colorTextTertiary}}),te(n)),{[`&${t}-checked`]:{background:n.switchColor,[`&:hover:not(${t}-disabled)`]:{background:n.colorPrimaryHover}},[`&${t}-loading, &${t}-disabled`]:{cursor:"not-allowed",opacity:n.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${t}-rtl`]:{direction:"rtl"}})}},$e=n=>{const{fontSize:t,lineHeight:r,controlHeight:a,colorWhite:c}=n,d=t*r,h=a/2,s=2,i=d-s*2,l=h-s*2;return{trackHeight:d,trackHeightSM:h,trackMinWidth:i*2+s*4,trackMinWidthSM:l*2+s*2,trackPadding:s,handleBg:c,handleSize:i,handleSizeSM:l,handleShadow:`0 2px 4px 0 ${new ae("#00230b").setA(.2).toRgbString()}`,innerMinMargin:i/2,innerMaxMargin:i+s+s*2,innerMinMarginSM:l/2,innerMaxMarginSM:l+s+s*2}},je=V("Switch",n=>{const t=ee(n,{switchDuration:n.motionDurationMid,switchColor:n.colorPrimary,switchDisabledOpacity:n.opacityLoading,switchLoadingIconSize:n.calc(n.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${n.opacityLoading})`,switchHandleActiveInset:"-30%"});return[Ie(t),be(t),Se(t),xe(t),pe(t)]},$e);var ye=function(n,t){var r={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&t.indexOf(a)<0&&(r[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,a=Object.getOwnPropertySymbols(n);c<a.length;c++)t.indexOf(a[c])<0&&Object.prototype.propertyIsEnumerable.call(n,a[c])&&(r[a[c]]=n[a[c]]);return r};const Ce=S.forwardRef((n,t)=>{const{prefixCls:r,size:a,disabled:c,loading:d,className:h,rootClassName:s,style:i,checked:l,value:u,defaultChecked:p,defaultValue:m,onChange:x}=n,b=ye(n,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[w,N]=F(!1,{value:l??u,defaultValue:p??m}),{getPrefixCls:f,direction:v,switch:y}=S.useContext(se),M=S.useContext(ie),D=(c??M)||d,j=f("switch",r),q=S.createElement("div",{className:`${j}-handle`},d&&S.createElement(ce,{className:`${j}-loading-icon`})),[I,E,k]=je(j),U=re(a),Z=W(y==null?void 0:y.className,{[`${j}-small`]:U==="small",[`${j}-loading`]:d,[`${j}-rtl`]:v==="rtl"},h,s,E,k),_=Object.assign(Object.assign({},y==null?void 0:y.style),i),G=(...H)=>{N(H[0]),x==null||x.apply(void 0,H)};return I(S.createElement(le,{component:"Switch"},S.createElement(K,Object.assign({},b,{checked:w,onChange:G,prefixCls:j,className:Z,style:_,disabled:D,ref:t,loadingIcon:q}))))}),we=Ce;we.__ANT_SWITCH=!0;const{TextArea:fe}=g,{Option:T}=X,Re=({visible:n,onClose:t,onSave:r,initialValues:a})=>{var i;const[c]=o.useForm(),[d,h]=R.useState(!1);R.useEffect(()=>{c.resetFields(),a&&c.setFieldsValue(a)},[a,c]);const s=()=>{c.validateFields().then(l=>{h(!0);const u=new Date().toLocaleString(),p=l.noteInput?{text:l.noteInput,timestamp:u}:null,m=(a==null?void 0:a.notes)||[],x=p?[...m,p]:m,b={...l,notes:x};delete b.noteInput,r(b),A.success(`Account ${a?"updated":"created"} successfully!`),h(!1),t()}).catch(l=>{console.log("Validate Failed:",l),A.error("Please fill all required fields correctly")})};return e.jsx(B,{title:a?"Edit Business Account":"Add New Business Account",width:720,onClose:t,open:n,bodyStyle:{paddingBottom:80},footer:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(L,{onClick:t,style:{marginRight:8},children:"Cancel"}),e.jsx(L,{onClick:s,type:"primary",loading:d,children:"Submit"})]}),children:e.jsxs(o,{form:c,layout:"vertical",children:[e.jsxs(P,{gutter:16,children:[e.jsx($,{span:12,children:e.jsx(o.Item,{name:"businessName",label:"Business Name",rules:[{required:!0,message:"Please enter business name"}],children:e.jsx(g,{placeholder:"Business Name"})})}),e.jsx($,{span:12,children:e.jsx(o.Item,{name:"gstNumber",label:"GST Number",rules:[{required:!0,message:"Please enter GST number"},{pattern:/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,message:"Invalid GST format"}],children:e.jsx(g,{placeholder:"22AABCU9603R12X"})})})]}),e.jsxs(P,{gutter:16,children:[e.jsx($,{span:12,children:e.jsx(o.Item,{name:"contactName",label:"Contact Name",rules:[{required:!0,message:"Please enter contact name"}],children:e.jsx(g,{placeholder:"Contact Name"})})}),e.jsx($,{span:12,children:e.jsx(o.Item,{name:"email",label:"Email Id",rules:[{required:!0,message:"Please enter email"},{type:"email",message:"Invalid email format"}],children:e.jsx(g,{placeholder:"Email Id"})})})]}),e.jsxs(P,{gutter:16,children:[e.jsx($,{span:12,children:e.jsx(o.Item,{name:"phoneNumber",label:"Phone Number",children:e.jsx(g,{placeholder:"0422 264925"})})}),e.jsx($,{span:12,children:e.jsx(o.Item,{name:"mobileNumber",label:"Mobile Number",rules:[{required:!0,message:"Please enter mobile number"}],children:e.jsx(g,{placeholder:"(123) 456-7890"})})})]}),e.jsx(o.Item,{name:"addressLine1",label:"Address Line 1",rules:[{required:!0,message:"Please enter address"}],children:e.jsx(g,{placeholder:"Address Line 1"})}),e.jsx(o.Item,{name:"addressLine2",label:"Address Line 2",children:e.jsx(g,{placeholder:"Address Line 2"})}),e.jsx(o.Item,{name:"addressLine3",label:"Address Line 3",children:e.jsx(g,{placeholder:"Address Line 3"})}),e.jsxs(P,{gutter:16,children:[e.jsx($,{span:8,children:e.jsx(o.Item,{name:"landmark",label:"Landmark",children:e.jsx(g,{placeholder:"Landmark"})})}),e.jsx($,{span:8,children:e.jsx(o.Item,{name:"city",label:"City",rules:[{required:!0,message:"Please enter city"}],children:e.jsx(g,{placeholder:"City"})})}),e.jsx($,{span:8,children:e.jsx(o.Item,{name:"pincode",label:"Pincode",rules:[{required:!0,message:"Please enter pincode"}],children:e.jsx(de,{style:{width:"100%"},placeholder:"Pincode"})})})]}),e.jsxs(P,{gutter:16,children:[e.jsx($,{span:12,children:e.jsx(o.Item,{name:"state",label:"State",rules:[{required:!0,message:"Please enter state"}],children:e.jsx(g,{placeholder:"State"})})}),e.jsx($,{span:12,children:e.jsx(o.Item,{name:"country",label:"Country",rules:[{required:!0,message:"Please enter country"}],children:e.jsx(g,{placeholder:"Country"})})})]}),e.jsx(o.Item,{name:"website",label:"Website URL",rules:[{type:"url",message:"Invalid URL format"}],children:e.jsx(g,{placeholder:"https://www.example.com"})}),e.jsx(o.Item,{name:"type",label:"Lead Type",rules:[{required:!0,message:"Please select a lead type"}],children:e.jsxs(X,{placeholder:"Select Type",children:[e.jsx(T,{value:"Hot",children:"Hot"}),e.jsx(T,{value:"Warm",children:"Warm"}),e.jsx(T,{value:"Cold",children:"Cold"})]})}),e.jsx(o.Item,{name:"noteInput",label:"Add Note",children:e.jsx(fe,{rows:3,placeholder:"Add a note (it will be timestamped)"})}),((i=a==null?void 0:a.notes)==null?void 0:i.length)>0&&e.jsxs("div",{style:{marginBottom:24},children:[e.jsx("label",{children:e.jsx("strong",{children:"Previous Notes"})}),e.jsx("ul",{style:{paddingLeft:20},children:a.notes.map((l,u)=>e.jsxs("li",{children:[e.jsxs("strong",{children:[l.timestamp,":"]})," ",l.text]},u))})]})]})})},{TextArea:ve}=g,{Title:ke,Text:Ne}=ue,Fe=({visible:n,onClose:t,account:r,refreshAccounts:a})=>{const[c]=o.useForm(),[d,h]=S.useState(!1),[s,i]=S.useState([]);S.useEffect(()=>{n&&(r!=null&&r._id)&&i(r.notes||[])},[n,r]);const l=()=>{try{const m=JSON.parse(localStorage.getItem("user"));return(m==null?void 0:m.email)||"Unknown"}catch{return"Unknown"}},u=async()=>{try{const{note:m}=await c.validateFields();h(!0);const x={text:m,timestamp:new Date().toLocaleString(),author:l()},b=[...s,x];await oe.put(`/api/accounts/${r._id}`,{...r,notes:b}),A.success("Note added successfully!"),i(b),c.resetFields(),a()}catch{A.error("Failed to add note.")}finally{h(!1)}},p=()=>!s||s.length===0?e.jsx(Ne,{type:"secondary",children:"No notes to show"}):s.map((m,x)=>{const b=x>0?s[x-1]:null,w=new Date(m.timestamp).toDateString(),N=b?new Date(b.timestamp).toDateString():null,f=w!==N;return e.jsxs("div",{children:[f&&e.jsx("div",{className:"note-date-header",children:w}),e.jsxs("div",{className:"note-bubble",children:[e.jsxs("div",{className:"note-meta",children:[m.author,"    ",m.timestamp]}),e.jsx("div",{className:"note-text",children:m.text})]})]},x)});return e.jsxs(B,{title:e.jsxs(ke,{level:4,style:{margin:0},children:["Notes for ",r.businessName]}),open:n,onClose:t,width:440,bodyStyle:{padding:"24px"},destroyOnClose:!0,children:[p(),e.jsx(he,{}),e.jsxs(o,{form:c,layout:"vertical",children:[e.jsx(o.Item,{name:"note",label:"Add Note",rules:[{required:!0,message:"Please enter a note"}],children:e.jsx(ve,{rows:3,placeholder:"Type your note here...",disabled:d})}),e.jsx(L,{type:"primary",icon:e.jsx(me,{}),onClick:u,loading:d,block:!0,children:"Add Note"})]})]})};export{Re as B,Fe as N,we as S};
