import{r,n}from"./index-Cutw-enT.js";import{i as p}from"./axios-0yhrvgHk.js";import{I as F,N as b}from"./InvoiceList-BmiML0Z7.js";import g from"./InvoiceForm-CUfe9xoB.js";import{D as L}from"./index-DxNPc3B1.js";import{s as i}from"./index-BRDnsLIx.js";import"./index-xsH4HHeE.js";import"./jspdf.es.min-3VB7ac1T.js";import"./jspdf.plugin.autotable-TLQB5wf7.js";import"./index-mDIpU0Wn.js";import"./row-CT_SkFWc.js";import"./TextArea-wS4BJCvv.js";import"./index-BR-p_aOo.js";import"./index-DhiKNL4W.js";import"./useClosable-CyT2u7CC.js";import"./index-B4mxXDrl.js";import"./Table-BcQs_2Pc.js";import"./index-BM5dM6cG.js";import"./index-BJ5DgSa8.js";import"./index-B7twddN4.js";import"./context-B6s9HnuY.js";import"./DeleteOutlined-y75rAjZs.js";import"./SendOutlined-B7SXhTJB.js";import"./index-6KKm8Dw0.js";import"./index-Bpnj6IYI.js";import"./PlusOutlined-BVrrzkCK.js";import"./index-Dr2qfWBK.js";import"./index-DIlPTcPi.js";import"./InfoCircleFilled-DImV3MXB.js";import"./index-D2q9Y2Gf.js";import"./MessageOutlined-BGxAE4eK.js";import"./callSuper-CJ6PLSkn.js";import"./index-Q2PMNF1e.js";import"./index-iu2pZ_PN.js";import"./SaveOutlined-D4dSPrMx.js";const de=()=>{const[d,C]=r.useState([]),[y,l]=r.useState(!1),[o,c]=r.useState(null),[u,S]=r.useState([]),[x,f]=r.useState(!1),a=async()=>{try{const t=await p.get("/api/invoices");C(t.data)}catch{i.error("Failed to fetch invoices")}};r.useEffect(()=>{a()},[]);const N=async t=>{var s,m;try{o&&o._id?(await p.put(`/api/invoices/${o._id}`,t),i.success("Invoice updated successfully")):(await p.post("/api/invoices",t),i.success("Invoice created successfully")),a(),l(!1),c(null)}catch(e){console.error(e),i.error(((m=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:m.message)||"Failed to save invoice")}},D=t=>{c(t),l(!0)},j=async t=>{try{await p.delete(`/api/invoices/${t}`),i.success("Invoice deleted"),a()}catch{i.error("Delete failed")}},E=t=>{const s=t.toLowerCase(),m=d.filter(e=>{var v,w,I;return((v=e==null?void 0:e.businessName)==null?void 0:v.toLowerCase().includes(s))||((w=e==null?void 0:e.invoiceNumber)==null?void 0:w.toLowerCase().includes(s))||((I=e==null?void 0:e.customerName)==null?void 0:I.toLowerCase().includes(s))});S(m)},h=()=>{l(!1),c(null)};return n.jsxs("div",{style:{padding:24},children:[n.jsx(F,{invoices:u.length>0?u:d,onAddNew:()=>{c(null),l(!0)},onEdit:D,onDelete:j,onSearch:E,refreshInvoices:a,onViewNotes:t=>{c(t),f(!0)}}),n.jsx(L,{title:o?"Edit Invoice":"Create Invoice",open:y,onClose:h,width:800,destroyOnClose:!0,children:n.jsx(g,{onCancel:h,onSave:N,initialValues:o})}),o&&n.jsx(b,{visible:x,onClose:()=>f(!1),invoice:o,refreshInvoices:a})]})};export{de as default};
