import{r as i,C as V,d as M,bg as he,g as be,m as ye,a as Ne,u as q,b2 as je,bh as Y,E as ve,I as Q,e as U,bi as we,J as Ce,x as t,S as Ie,B as Z}from"./index-C0grwz79.js";import{i as E}from"./axios-tnHzrPy3.js";import{T as Se}from"./index-BENBeHcC.js";import{a as Oe,E as B}from"./index-DtugcRK_.js";import{p as ae}from"./TextArea-CAkGYrr4.js";import{C as Ae}from"./index-foP-l8oB.js";import{D as u}from"./index-DvDZq9fj.js";import{T as ee}from"./index-CHqsFLsH.js";import{T as ne}from"./index-DAzwC3B8.js";import{C as oe}from"./Collapse-1eAb84vA.js";import{F as Pe}from"./Table-BZhqThb7.js";import{R as Ee}from"./FallOutlined-CKm0QHaL.js";import{L as D}from"./index-D8brbAia.js";import"./EditOutlined-CPob1B0O.js";import"./useClosable-ByguMb4q.js";import"./addEventListener-De-JxrLM.js";import"./index-eHFdk1B_.js";const L=({children:e})=>{const{getPrefixCls:n}=i.useContext(V),r=n("breadcrumb");return i.createElement("li",{className:`${r}-separator`,"aria-hidden":"true"},e===""?e:e||"/")};L.__ANT_BREADCRUMB_SEPARATOR=!0;var $e=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r};function Be(e,n){if(e.title===void 0||e.title===null)return null;const r=Object.keys(n).join("|");return typeof e.title=="object"?e.title:String(e.title).replace(new RegExp(`:(${r})`,"g"),(s,o)=>n[o]||s)}function le(e,n,r,s){if(r==null)return null;const{className:o,onClick:d}=n,m=$e(n,["className","onClick"]),g=Object.assign(Object.assign({},ae(m,{data:!0,aria:!0})),{onClick:d});return s!==void 0?i.createElement("a",Object.assign({},g,{className:M(`${e}-link`,o),href:s}),r):i.createElement("span",Object.assign({},g,{className:M(`${e}-link`,o)}),r)}function De(e,n){return(s,o,d,m,g)=>{if(n)return n(s,o,d,m);const y=Be(s,o);return le(e,s,y,g)}}var X=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r};const ie=e=>{const{prefixCls:n,separator:r="/",children:s,menu:o,overlay:d,dropdownProps:m,href:g}=e,j=(v=>{if(o||d){const w=Object.assign({},m);if(o){const S=o||{},{items:C}=S,p=X(S,["items"]);w.menu=Object.assign(Object.assign({},p),{items:C==null?void 0:C.map((h,f)=>{var{key:N,title:O,label:a,path:l}=h,x=X(h,["key","title","label","path"]);let b=a??O;return l&&(b=i.createElement("a",{href:`${g}${l}`},b)),Object.assign(Object.assign({},x),{key:N??f,label:b})})})}else d&&(w.overlay=d);return i.createElement(he,Object.assign({placement:"bottom"},w),i.createElement("span",{className:`${n}-overlay-link`},v,i.createElement(Oe,null)))}return v})(s);return j!=null?i.createElement(i.Fragment,null,i.createElement("li",null,j),r&&i.createElement(L,null,r)):null},ce=e=>{const{prefixCls:n,children:r,href:s}=e,o=X(e,["prefixCls","children","href"]),{getPrefixCls:d}=i.useContext(V),m=d("breadcrumb",n);return i.createElement(ie,Object.assign({},o,{prefixCls:m}),le(m,o,r,s))};ce.__ANT_BREADCRUMB_ITEM=!0;const Re=e=>{const{componentCls:n,iconCls:r,calc:s}=e;return{[n]:Object.assign(Object.assign({},Ne(e)),{color:e.itemColor,fontSize:e.fontSize,[r]:{fontSize:e.iconFontSize},ol:{display:"flex",flexWrap:"wrap",margin:0,padding:0,listStyle:"none"},a:Object.assign({color:e.linkColor,transition:`color ${e.motionDurationMid}`,padding:`0 ${q(e.paddingXXS)}`,borderRadius:e.borderRadiusSM,height:e.fontHeight,display:"inline-block",marginInline:s(e.marginXXS).mul(-1).equal(),"&:hover":{color:e.linkHoverColor,backgroundColor:e.colorBgTextHover}},je(e)),"li:last-child":{color:e.lastItemColor},[`${n}-separator`]:{marginInline:e.separatorMargin,color:e.separatorColor},[`${n}-link`]:{[`
          > ${r} + span,
          > ${r} + a
        `]:{marginInlineStart:e.marginXXS}},[`${n}-overlay-link`]:{borderRadius:e.borderRadiusSM,height:e.fontHeight,display:"inline-block",padding:`0 ${q(e.paddingXXS)}`,marginInline:s(e.marginXXS).mul(-1).equal(),[`> ${r}`]:{marginInlineStart:e.marginXXS,fontSize:e.fontSizeIcon},"&:hover":{color:e.linkHoverColor,backgroundColor:e.colorBgTextHover,a:{color:e.linkHoverColor}},a:{"&:hover":{backgroundColor:"transparent"}}},[`&${e.componentCls}-rtl`]:{direction:"rtl"}})}},Le=e=>({itemColor:e.colorTextDescription,lastItemColor:e.colorText,iconFontSize:e.fontSize,linkColor:e.colorTextDescription,linkHoverColor:e.colorText,separatorColor:e.colorTextDescription,separatorMargin:e.marginXS}),Te=be("Breadcrumb",e=>{const n=ye(e,{});return Re(n)},Le);var te=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r};function _e(e){const{breadcrumbName:n,children:r}=e,s=te(e,["breadcrumbName","children"]),o=Object.assign({title:n},s);return r&&(o.menu={items:r.map(d=>{var{breadcrumbName:m}=d,g=te(d,["breadcrumbName"]);return Object.assign(Object.assign({},g),{title:m})})}),o}function ze(e,n){return i.useMemo(()=>e||(n?n.map(_e):null),[e,n])}var Fe=function(e,n){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r};const He=(e,n)=>{if(n===void 0)return n;let r=(n||"").replace(/^\//,"");return Object.keys(e).forEach(s=>{r=r.replace(`:${s}`,e[s])}),r},K=e=>{const{prefixCls:n,separator:r="/",style:s,className:o,rootClassName:d,routes:m,items:g,children:y,itemRender:j,params:v={}}=e,w=Fe(e,["prefixCls","separator","style","className","rootClassName","routes","items","children","itemRender","params"]),{getPrefixCls:S,direction:C,breadcrumb:p}=i.useContext(V);let h;const f=S("breadcrumb",n),[N,O,a]=Te(f),l=ze(g,m),x=De(f,j);if(l&&l.length>0){const A=[],P=g||m;h=l.map((I,$)=>{const{path:de,key:_,type:me,menu:G,overlay:J,onClick:ue,className:xe,separator:ge,dropdownProps:pe}=I,z=He(v,de);z!==void 0&&A.push(z);const W=_??$;if(me==="separator")return i.createElement(L,{key:W},ge);const F={},fe=$===l.length-1;G?F.menu=G:J&&(F.overlay=J);let{href:H}=I;return A.length&&z!==void 0&&(H=`#/${A.join("/")}`),i.createElement(ie,Object.assign({key:W},F,ae(I,{data:!0,aria:!0}),{className:xe,dropdownProps:pe,href:H,separator:fe?"":r,onClick:ue,prefixCls:f}),x(I,v,P,A,H))})}else if(y){const A=Y(y).length;h=Y(y).map((P,I)=>{if(!P)return P;const $=I===A-1;return ve(P,{separator:$?"":r,key:I})})}const b=M(f,p==null?void 0:p.className,{[`${f}-rtl`]:C==="rtl"},o,d,O,a),T=Object.assign(Object.assign({},p==null?void 0:p.style),s);return N(i.createElement("nav",Object.assign({className:b,style:T},w),i.createElement("ol",null,h)))};K.Item=ce;K.Separator=L;var ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},Me=function(n,r){return i.createElement(Q,U({},n,{ref:r,icon:ke}))},re=i.forwardRef(Me),Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"},Ve=function(n,r){return i.createElement(Q,U({},n,{ref:r,icon:Xe}))},se=i.forwardRef(Ve),Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},Ue=function(n,r){return i.createElement(Q,U({},n,{ref:r,icon:Qe}))},Ke=i.forwardRef(Ue);const{TabPane:k}=ne,{Title:R,Text:c}=Se,{Panel:Ge}=oe,ut=()=>{const{id:e}=we(),n=Ce(),[r,s]=i.useState(null),[o,d]=i.useState(!0),[m,g]=i.useState([]),[y,j]=i.useState([]),[v,w]=i.useState([]),[S,C]=i.useState([]);if(i.useEffect(()=>{d(!0),Promise.all([E.get(`/api/accounts/${e}`),E.get(`/api/quotations/business/${e}`),E.get(`/api/invoices/business/${e}`),E.get(`/api/accounts/${e}/followups`),E.get(`/api/invoices/business/${e}/payments`)]).then(([a,l,x,b,T])=>{s(a.data),g(l.data||[]),j(x.data||[]),w(b.data||[]),C(T.data||[])}).catch(a=>{console.error("Failed to load data:",a)}).finally(()=>d(!1))},[e]),o)return t.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-50",children:t.jsx(Ie,{size:"large",tip:"Loading Customer Profile..."})});if(!r)return t.jsxs("div",{className:"p-6 bg-white shadow-lg rounded-lg m-6",children:[t.jsx(Z,{className:"mb-4 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-md transition duration-300 ease-in-out",icon:t.jsx(re,{}),onClick:()=>n("/customers"),children:"Back to Customers"}),t.jsx(R,{level:3,className:"mt-4 text-center text-gray-700",children:"Customer Not Found"}),t.jsx(B,{description:"No data found for this customer ID. It might not exist or there was an issue fetching it.",className:"mt-8"})]});const p=[...v].sort((a,l)=>new Date(l.followupDate||l.date)-new Date(a.followupDate||a.date)),h=[...r.notes||[]].sort((a,l)=>new Date(l.timestamp)-new Date(a.timestamp)),f=a=>`₹${Number(a||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,N=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}catch(l){return console.error("Error formatting date:",a,l),a}},O=a=>{const l=[];return a.addressLine1&&l.push(a.addressLine1),a.addressLine2&&l.push(a.addressLine2),a.addressLine3&&l.push(a.addressLine3),a.city&&l.push(a.city),a.state&&l.push(a.state),a.pincode&&l.push(a.pincode),a.country&&l.push(a.country),l.length>0?l.join(", "):"N/A"};return y.reduce((a,l)=>a+(l.totalAmount||0),0),S.reduce((a,l)=>a+(l.amount||0),0),t.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen font-sans",children:[t.jsx(Z,{className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out flex items-center space-x-2",icon:t.jsx(re,{}),onClick:()=>n(-1),children:"Back"}),t.jsx(K,{className:"mb-4 text-gray-600 mt-5 font-medium",items:[{title:"Customers",href:"/customers"},{title:r.businessName||"Profile"}]}),t.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-4 sm:space-y-0",children:t.jsxs(R,{level:2,className:"text-gray-800 font-extrabold mb-0 text-center sm:text-left",children:[r.businessName," Profile"]})}),t.jsx(Ae,{title:t.jsx(R,{level:4,className:"text-gray-800 font-bold mb-0",children:"Customer Details"}),className:"shadow-xl rounded-xl mb-8 border-t-8 border-blue-600 transform hover:scale-100 transition duration-300 ease-in-out",children:t.jsxs(u,{bordered:!0,column:{xs:1,sm:2,md:2,lg:3},size:"middle",className:"text-gray-700",children:[t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Business Name"}),children:t.jsx(c,{strong:!0,className:"text-gray-900",children:r.businessName||"N/A"})}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"GSTIN"}),children:r.gstNumber||"N/A"}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Customer Name"}),children:r.contactName||"N/A"}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Email"}),children:r.email||"N/A"}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Phone Number"}),children:r.phoneNumber||"N/A"}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Status"}),children:t.jsx(ee,{color:r.status==="Active"?"green":r.status==="Inactive"?"red":"blue",className:"rounded-full px-3 py-1 text-sm font-medium",children:r.status||"N/A"})}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Type"}),children:r.type||"N/A"}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Customer Address"}),span:3,children:O(r)}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Created At"}),children:r.createdAt?new Date(r.createdAt).toLocaleString():"N/A"}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Last Updated"}),children:r.updatedAt?new Date(r.updatedAt).toLocaleString():"N/A"})]})}),t.jsxs(ne,{defaultActiveKey:"1",className:"bg-white p-4 rounded-xl shadow-xl",tabBarStyle:{marginBottom:24},children:[t.jsx(k,{tab:t.jsxs("span",{className:"flex items-center space-x-2 text-lg font-semibold text-gray-700 hover:text-blue-600 transition-colors duration-200",children:[t.jsx(Ee,{className:"text-xl"}),t.jsxs("span",{children:["Quotations (",m.length,")"]})]}),children:m.length===0?t.jsx(B,{description:"No quotations found for this customer.",className:"py-8"}):t.jsx(oe,{accordion:!0,className:"shadow-md rounded-lg overflow-hidden",expandIconPosition:"end",children:m.map((a,l)=>t.jsxs(Ge,{header:t.jsxs("div",{className:"font-semibold text-lg flex justify-between items-center py-2",children:[t.jsxs("span",{className:"text-gray-800",children:["Quotation #",a.quotationNumber||"N/A"]}),t.jsx("span",{className:"text-green-600 text-xl font-bold",children:f(a.totalAmount)})]}),className:"bg-white border-b border-gray-200 rounded-lg mb-2 overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-200 ease-in-out",children:[t.jsxs(u,{bordered:!0,column:{xs:1,sm:2,md:2},size:"small",className:"mb-4 text-gray-700",children:[t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Date"}),children:N(a.date)}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Status"}),children:t.jsx(ee,{color:a.status==="Approved"?"green":a.status==="Pending"?"orange":a.status==="Rejected"?"red":"blue",className:"rounded-full px-3 py-1 text-sm font-medium",children:a.status||"N/A"})}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Customer Name"}),children:r.contactName||"N/A"}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"GSTIN"}),children:r.gstNumber||"N/A"}),t.jsx(u.Item,{label:t.jsx(c,{strong:!0,className:"text-gray-600",children:"Customer Address"}),span:2,children:O(r)})]}),t.jsx(R,{level:5,className:"mt-6 mb-3 text-gray-800 font-bold",children:"Items Quoted"}),t.jsx(Pe,{dataSource:a.items||[],columns:[{title:"Product Name",dataIndex:"productName",key:"productName",render:x=>x||"N/A"},{title:"Description",dataIndex:"description",key:"description"},{title:"HSN/SAC",dataIndex:"hsn",key:"hsn"},{title:"Qty",dataIndex:"quantity",key:"quantity"},{title:"Rate (₹)",dataIndex:"rate",key:"rate",render:x=>f(x)},{title:"Amount (₹)",dataIndex:"amount",key:"amount",render:x=>f(x)}],pagination:!1,rowKey:(x,b)=>b,size:"small",className:"border border-gray-200 rounded-md overflow-hidden shadow-sm"})]},a._id||l))})},"1"),t.jsx(k,{tab:t.jsxs("span",{className:"flex items-center space-x-2 text-lg font-semibold text-gray-700 hover:text-blue-600 transition-colors duration-200",children:[t.jsx(Ke,{className:"text-xl"}),t.jsxs("span",{children:["Follow-ups (",p.length,")"]})]}),children:p.length===0?t.jsx(B,{description:"No follow-ups found for this customer.",className:"py-8"}):t.jsx(D,{bordered:!0,dataSource:p,className:"rounded-lg overflow-hidden shadow-md",renderItem:a=>t.jsx(D.Item,{className:"flex flex-col items-start bg-white p-5 hover:bg-gray-50 transition-colors duration-200 border-b border-gray-200 last:border-b-0",children:t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"font-semibold text-gray-800 text-base mb-2 flex items-center",children:[t.jsx("span",{className:"mr-3 text-blue-500 text-xl",children:t.jsx(se,{})}),t.jsx(c,{strong:!0,children:"Date:"})," ",t.jsx("span",{className:"ml-2",children:N(a.followupDate||a.date)})]}),t.jsxs("div",{className:"text-gray-800 mb-2 leading-relaxed text-base",children:[t.jsx(c,{strong:!0,children:"Note:"})," ",a.note||a.comment||"No comment provided"]}),a.addedBy&&t.jsxs("div",{className:"text-sm text-gray-500 mt-3 border-t border-gray-100 pt-2",children:["Added by: ",t.jsx(c,{italic:!0,children:a.addedBy.name||a.addedBy.email||"Unknown"})]})]})})})},"3"),t.jsx(k,{tab:t.jsxs("span",{className:"flex items-center space-x-2 text-lg font-semibold text-gray-700 hover:text-blue-600 transition-colors duration-200",children:[t.jsx(se,{className:"text-xl"}),t.jsxs("span",{children:["Notes (",h.length,")"]})]}),children:h.length===0?t.jsx(B,{description:"No notes available for this customer.",className:"py-8"}):t.jsx(D,{bordered:!0,dataSource:h,className:"rounded-lg overflow-hidden shadow-md",renderItem:a=>{var l,x;return t.jsx(D.Item,{className:"flex flex-col items-start bg-white p-5 hover:bg-gray-50 transition-colors duration-200 border-b border-gray-200 last:border-b-0",children:t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"text-gray-800 text-base leading-relaxed mb-2",children:[t.jsx(c,{strong:!0,children:"Note:"})," ",a.text||"No text provided"]}),t.jsxs("div",{className:"text-sm text-gray-500 mt-3 border-t border-gray-100 pt-2",children:["Added by: ",t.jsx(c,{italic:!0,children:a.author||((l=a.addedBy)==null?void 0:l.name)||((x=a.addedBy)==null?void 0:x.email)||"Unknown"})," | ",a.timestamp?new Date(a.timestamp).toLocaleString():"N/A"]})]})})}})},"5")]})]})};export{ut as default};
