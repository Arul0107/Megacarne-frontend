import{r as i,n as l}from"./index-DOl5o0Fi.js";import N from"./InvoiceList-CyAGkuqo.js";import D from"./InvoiceForm-BhcbDRdu.js";import{s}from"./index-D0cqfMpl.js";import{D as F}from"./index-C1jWW2JK.js";import"./jspdf.es.min-BGRMkKsu.js";import"./jspdf.plugin.autotable-TLQB5wf7.js";import"./index-xsH4HHeE.js";import"./index-BGklyIoz.js";import"./row-Py5ar9wK.js";import"./TextArea-C4DPS5YY.js";import"./index-BuLJMp6D.js";import"./index-CSGtnS7J.js";import"./useClosable-B_lu9RL-.js";import"./index-DdA_pnqc.js";import"./Table-C5Y_brLg.js";import"./index-CcH3ZLi-.js";import"./index-urhnUZZj.js";import"./index-CKdYz8QF.js";import"./context-CmZbqAFB.js";import"./DeleteOutlined-CLFo74kb.js";import"./SendOutlined-YVBdKRQR.js";import"./index-SpzIKIyO.js";import"./index-BzoFmVq5.js";import"./PlusOutlined-FiOkOQB_.js";import"./index-C4VLxRWm.js";import"./index-JO2pgooI.js";import"./InfoCircleFilled-BfnhUeHt.js";import"./index-BTWPr2ot.js";import"./MessageOutlined-DbPnkpAp.js";import"./callSuper-fVTTMkTX.js";import"./index-6_qPCQ4T.js";import"./index-6Ojxmyu-.js";import"./SaveOutlined-CD04mnLS.js";const ae=()=>{const[d,I]=i.useState([]),[y,n]=i.useState(!1),[o,c]=i.useState(null),[u,h]=i.useState([]);i.useEffect(()=>{a()},[]);const a=async()=>{try{const t=await(await fetch("/api/invoices")).json();I(t)}catch{s.error("Failed to fetch invoices")}},S=async e=>{try{const t=o?"PUT":"POST",p=o?`/api/invoices/${o._id}`:"/api/invoices",r=await fetch(p,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),m=await r.json();if(r.ok)s.success(o?"Invoice updated":"Invoice created"),a(),n(!1),c(null);else throw new Error(m.error||"Failed to save")}catch(t){s.error(t.message)}},C=e=>{c(e),n(!0)},E=async e=>{try{await fetch(`/api/invoices/${e}`,{method:"DELETE"}),s.success("Invoice deleted"),a()}catch{s.error("Delete failed")}},j=()=>{n(!0),c(null)},v=()=>{n(!1),c(null)},x=e=>{if(!e)return h([]);const t=e.toLowerCase(),p=d.filter(r=>{var m,f,w;return((m=r.businessName)==null?void 0:m.toLowerCase().includes(t))||((f=r.invoiceNumber)==null?void 0:f.toLowerCase().includes(t))||((w=r.customerName)==null?void 0:w.toLowerCase().includes(t))});h(p)};return l.jsxs("div",{style:{padding:24},children:[l.jsx(N,{invoices:u.length>0?u:d,onAddNew:j,onEdit:C,onDelete:E,onSearch:x,refreshInvoices:a}),l.jsx(F,{title:o?"Edit Invoice":"New Invoice",width:800,open:y,onClose:v,destroyOnClose:!0,children:l.jsx(D,{onCancel:v,onSave:S,initialValues:o})})]})};export{ae as default};
